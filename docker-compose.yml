services:
  core:
    build: ./core
    profiles: [core, all]
    ports: ["8000:8000"]
    volumes:
      - "./vault:/vault"
      - "qmd_cache:/root/.cache/qmd"
    environment:
      - VAULT_PATH=/vault
      - NODE_LLAMA_CPP_GPU=false

  web:
    build: ./web
    profiles: [web, all]
    ports: ["5173:5173"]

volumes:
  qmd_cache: